<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>iOS Settings Enhanced Prototype</title>
  <style>
    @font-face {
      font-family: 'SF Pro Text';
      src: local(-apple-system), local('SF Pro Text'), local('San Francisco');
      font-weight: normal;
    }
    @font-face {
      font-family: 'SF Pro Display';
      src: local(-apple-system), local('SF Pro Display'), local('San Francisco');
      font-weight: bold;
    }
    @font-face {
      font-family: 'SF Pro Text';
      src: local(-apple-system), local('SF Pro Text'), local('San Francisco');
      font-weight: 450;
      font-style: normal;
    }

    /* CSS Variables for Consistent Theming */
    :root {
      --ios-background: #f2f2f7;
      --ios-blue: #007aff;
      --ios-green: #34c759;
      --ios-orange: #ff9500;
      --ios-border: #c7c7cc;
      --ios-text: #1c1c1e;
      --ios-secondary-text: #8e8e93;
      --ios-white: #fff;
      --ios-dark-background: #000;
      --ios-dark-text: #fff;
      --ios-dark-secondary-text: #ccc;
      --ios-dark-border: #333;
    }
    [data-theme="dark"] {
      --ios-background: var(--ios-dark-background);
      --ios-text: var(--ios-dark-text);
      --ios-secondary-text: var(--ios-dark-secondary-text);
      --ios-border: var(--ios-dark-border);
      --ios-white: #1c1c1e;
    }

    /* Reset & Base Styles */
    * {
      margin: 0; padding: 0; box-sizing: border-box;
    }
    html, body {
      background-color: var(--ios-background);
      font-family: 'SF Pro Text', -apple-system, system-ui, sans-serif;
      color: var(--ios-text);
      -webkit-font-smoothing: antialiased;
      width: 100%; height: 100%;
      scroll-behavior: smooth;
    }

    .container {
      max-width: 390px;
      min-height: 100vh;
      margin: 20px auto;
      background-color: var(--ios-background);
      position: relative;
      border: 2px solid #aaa;
      border-radius: 40px;
      overflow: hidden;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
    }

    /* Search Overlay */
    .search-overlay {
      position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      background-color: transparent;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
      z-index: 20;
    }
    .search-overlay.active {
      background-color: rgba(0,0,0,0.4);
      opacity: 1;
      pointer-events: auto;
    }

    /* Status Bar */
    .status-bar {
      display: flex; justify-content: space-between; align-items: center;
      padding: 8px 15px; font-size: 14px; color: var(--ios-text);
      z-index: 3; position: relative;
    }
    .status-bar .time {
      font-size: 16px; font-weight: 500; line-height: 1; padding-left: 8px;
    }
    .status-bar .right {
      display: flex; gap: 3px; align-items: center;
    }
    .status-bar img {
      height: 15px; width: auto;
    }
    .status-bar img[alt="LTE Status"] {
      width: 24px; height: auto;
    }
    .status-bar img[alt="Airplane Status"] {
      display: none; width: 18px; height: auto;
    }

    /* Breadcrumbs */
    .breadcrumb {
      margin: 5px 16px;
      font-size: 14px;
      color: var(--ios-secondary-text);
      display: flex;
      align-items: center;
      gap: 5px;
      z-index: 3;
      position: relative;
    }
    .breadcrumb-separator {
      color: var(--ios-border);
    }

    /* Header */
    .header {
      font-family: 'SF Pro Display', -apple-system, system-ui, sans-serif;
      font-size: 34px; font-weight: 700;
      margin: 10px 16px 20px;
      letter-spacing: -0.5px;
      z-index: 3; position: relative;
      transition: font-size 0.2s ease, margin 0.2s ease;
    }
    .header.compact {
      font-size: 24px;
      margin: 5px 16px 10px;
    }

    /* Search Bar */
    .search-container {
      margin: 0 16px 10px; position: relative; z-index: 30;
    }
    .search-bar {
      width: 100%; padding: 10px 45px 10px 40px; border-radius: 22px;
      border: 1px solid var(--ios-border); background-color: var(--ios-white);
      font-size: 16px; color: var(--ios-text);
      transition: border-color 0.2s ease, box-shadow 0.2s ease, transform 0.15s ease;
    }
    .search-bar:focus {
      border-color: var(--ios-blue);
      box-shadow: 0 0 4px rgba(0,122,255,0.3);
      outline: none;
      transform: scale(0.99);
    }
    .search-bar::placeholder {
      color: rgba(0,0,0,0.4);
    }
    .search-icon {
      position: absolute; left: 14px; top: 10px;
      pointer-events: none; height: 18px; width: auto;
    }
    .clear-icon {
      position: absolute; right: 14px; top: 10px;
      font-size: 16px; color: var(--ios-secondary-text); cursor: pointer;
      transition: opacity 0.2s ease; opacity: 0;
    }
    .clear-icon.visible {
      opacity: 1;
    }

    /* Search Results */
    .search-results {
      position: absolute; top: 48px; left: 0; right: 0;
      background-color: var(--ios-white); border-radius: 10px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.2);
      max-height: 0; overflow: hidden;
      transition: max-height 0.3s ease;
      z-index: 31;
    }
    .search-results.active {
      max-height: 300px; overflow-y: auto;
    }
    .search-result-item {
      display: flex; align-items: center;
      padding: 12px 16px; border-bottom: 1px solid rgba(60,60,67,0.13);
      cursor: pointer;
    }
    .search-result-item:last-child {
      border-bottom: none;
    }
    .search-result-item:hover {
      background-color: var(--ios-background);
    }
    .search-result-icon {
      width: 26px; height: 26px; border-radius: 6px;
      display: flex; justify-content: center; align-items: center;
      margin-right: 12px; margin-left: -6px; position: relative;
    }
    .search-result-name {
      font-size: 16px; font-weight: 450;
    }
    .search-category {
      font-size: 12px; color: var(--ios-secondary-text);
      margin-left: auto; padding-left: 8px;
    }
    .search-highlight {
      background-color: rgba(0,122,255,0.1); color: var(--ios-blue);
      border-radius: 3px;
    }
    .no-results {
      padding: 16px; text-align: center;
      color: var(--ios-secondary-text); font-size: 15px;
    }
    .search-result-toggle {
      margin-left: auto; padding-left: 8px;
    }
    .search-result-control {
      margin-left: auto; display: flex; align-items: center; gap: 8px;
    }
    .search-brightness-range {
      width: 120px;
    }
    .text-size-control button {
      width: 28px; height: 28px; border: none; border-radius: 4px;
      background-color: #e0e0e0; font-size: 18px; cursor: pointer;
    }
    .text-size-control .text-size-value {
      min-width: 32px; text-align: center; font-size: 15px;
    }

    /* Profile Section */
    .profile-section {
      margin: 0 16px 16px; border-radius: 10px; background-color: var(--ios-white);
      border: 1px solid var(--ios-border); overflow: hidden;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    .profile-item {
      display: flex; align-items: center;
      padding: 16px; cursor: pointer;
      transition: background-color 0.15s ease;
    }
    .profile-item:hover {
      background-color: #f9f9f9;
    }
    .profile-avatar {
      width: 60px; height: 60px; border-radius: 50%;
      background: #e0e0e0; margin-right: 12px; overflow: hidden; flex-shrink: 0;
    }
    .profile-avatar img {
      width: 100%; height: 100%; object-fit: cover;
    }
    .profile-info {
      display: flex; flex-direction: column;
    }
    .profile-name {
      font-size: 18px; font-weight: 600; margin-bottom: 2px;
    }
    .profile-email {
      font-size: 13px; color: var(--ios-secondary-text);
    }
    .profile-chevron {
      margin-left: auto; color: var(--ios-border);
    }

    /* Pinned Section */
    .pinned-section {
      position: sticky; top: 0; z-index: 2;
      margin: 0 16px 16px; padding: 12px 0; background-color: var(--ios-background);
    }
    .connectivity-controls {
      display: flex; justify-content: space-around; gap: 8px;
    }
    .connectivity-button {
      display: flex; flex-direction: column; align-items: center;
      width: 70px; cursor: pointer;
    }
    .connectivity-icon {
      width: 50px; height: 50px; border-radius: 50%;
      background-color: var(--ios-border); display: flex; justify-content: center; align-items: center;
      margin-bottom: 6px; transition: background-color 0.2s ease;
    }
    .connectivity-icon.icon-wifi.active,
    .connectivity-icon.icon-bluetooth.active {
      background-color: var(--ios-blue);
    }
    .connectivity-icon.icon-cellular.active {
      background-color: var(--ios-green);
    }
    .connectivity-icon.icon-airplane.active {
      background-color: var(--ios-orange);
    }
    .connectivity-icon img {
      width: 24px; height: auto;
    }
    .connectivity-label {
      font-size: 12px; text-align: center; color: var(--ios-text);
    }

    /* Collapsible Sections */
    .section-header {
      font-weight: 600; font-size: 15px;
      margin: 15px 16px 5px; color: var(--ios-secondary-text); text-transform: uppercase;
      letter-spacing: 0.4px; z-index: 2; position: relative; cursor: pointer;
      display: flex; align-items: center; justify-content: space-between;
    }
    .collapse-arrow {
      transition: transform 0.2s ease; font-size: 14px; margin-left: 8px;
    }
    .collapsed-arrow {
      transform: rotate(-90deg);
    }
    .collapsed {
      display: none;
    }

    /* Sections & List Items */
    .section {
      margin: 0 16px; border-radius: 10px; background-color: var(--ios-white);
      border: 1px solid var(--ios-border); margin-bottom: 15px; overflow: hidden;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      transition: transform 0.3s ease, opacity 0.3s ease;
    }
    .section.slide-left {
      transform: translateX(-100%);
      opacity: 0;
    }
    .section-item {
      display: flex; justify-content: space-between; align-items: center;
      padding: 12px 16px; border-bottom: 1px solid var(--ios-border);
      height: 44px; transition: background-color 0.15s ease, transform 0.1s ease;
      cursor: pointer;
    }
    .section-item:hover {
      background-color: rgba(0, 0, 0, 0.02);
    }
    .section-item:active {
      transform: scale(0.98);
    }
    .section-item:focus-visible {
      outline: 2px solid var(--ios-blue);
      outline-offset: -2px;
    }
    .section-item:last-child {
      border-bottom: none;
    }
    .section-item.setting-changed {
      animation: pulse 0.3s ease;
    }
    .left-content {
      display: flex; align-items: center; gap: 10px;
    }
    .item-name {
      font-size: 16px; font-weight: 400; color: var(--ios-text);
    }
    .right-content {
      color: var(--ios-secondary-text); font-size: 16px; display: flex; align-items: center;
      position: relative;
    }
    .chevron {
      margin-left: 8px; color: var(--ios-border);
    }
    .item-icon {
      width: 26px; height: 26px; border-radius: 6px;
      display: flex; justify-content: center; align-items: center;
      flex-shrink: 0; margin-left: -6px; position: relative;
    }
    .item-icon img {
      width: 20px; height: auto;
    }
    .update-badge {
      position: absolute;
      top: -5px;
      right: -5px;
      background-color: #ff3b30;
      color: white;
      border-radius: 10px;
      padding: 2px 6px;
      font-size: 12px;
      font-weight: bold;
    }

    /* Tinted Backgrounds */
    .section-item .item-icon.icon-wifi { background-color: var(--ios-blue); }
    .section-item .item-icon.icon-bluetooth { background-color: var(--ios-blue); }
    .section-item .item-icon.icon-battery { background-color: var(--ios-green); }
    .section-item .item-icon.icon-cellular { background-color: var(--ios-green); }
    .section-item .item-icon.icon-display { background-color: var(--ios-orange); }
    .section-item .item-icon.icon-darkmode { background-color: var(--ios-secondary-text); }
    .section-item .item-icon.icon-text { background-color: var(--ios-blue); }
    .section-item .item-icon.icon-update { background-color: var(--ios-secondary-text); }
    .section-item .item-icon.icon-storage { background-color: var(--ios-secondary-text); }
    .section-item .item-icon.icon-hotspot { background-color: var(--ios-green); }
    .section-item .item-icon.icon-reset { background-color: var(--ios-secondary-text); }

    /* Brightness Slider */
    .brightness-controls {
      display: flex; align-items: center; gap: 10px;
    }
    .brightness-range {
      -webkit-appearance: none; appearance: none;
      width: 100px; height: 6px; background: #e9e9eb; border-radius: 3px;
      outline: none; transition: background 0.2s ease;
    }
    .brightness-range::-webkit-slider-thumb {
      -webkit-appearance: none; appearance: none;
      width: 18px; height: 18px; border-radius: 50%; background: var(--ios-blue);
      cursor: pointer;
    }
    .brightness-range::-moz-range-thumb {
      width: 18px; height: 18px; border-radius: 50%; background: var(--ios-blue); cursor: pointer;
    }

    /* Toggle Switch */
    .toggle-switch {
      width: 51px; height: 31px; background-color: #e9e9eb;
      border-radius: 16px; position: relative;
      transition: background-color 0.2s ease; cursor: pointer;
    }
    .toggle-switch.active {
      background-color: var(--ios-green);
    }
    .toggle-switch::before {
      content: ''; position: absolute; width: 27px; height: 27px;
      border-radius: 50%; background-color: white;
      top: 2px; left: 2px; transition: transform 0.2s cubic-bezier(0.165, 0.84, 0.44, 1);
      box-shadow: 0 1px 2px rgba(0,0,0,0.2);
    }
    .toggle-switch.active::before {
      transform: translateX(20px);
    }

    /* Pull-to-Refresh */
    .pull-indicator {
      position: absolute;
      top: -40px;
      left: 0;
      right: 0;
      text-align: center;
      background-color: var(--ios-background);
      padding: 10px;
      font-size: 14px;
      color: var(--ios-secondary-text);
      opacity: 0;
      transition: opacity 0.2s ease, top 0.2s ease;
    }
    .pull-indicator.visible {
      opacity: 1;
      top: 0;
    }

    /* Quick Settings Panel */
    .quick-settings-handle {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 20px;
      background-color: transparent;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10;
    }
    .handle-indicator {
      width: 40px;
      height: 5px;
      background-color: var(--ios-border);
      border-radius: 2.5px;
    }
    .quick-settings-panel {
      position: fixed;
      bottom: -100%;
      left: 0;
      right: 0;
      height: 200px;
      background-color: var(--ios-background);
      transition: bottom 0.3s ease;
      z-index: 9;
      display: flex;
      justify-content: space-around;
      align-items: center;
      padding: 20px;
    }
    .quick-settings-panel.active {
      bottom: 0;
    }
    .quick-toggle {
      display: flex;
      flex-direction: column;
      align-items: center;
      cursor: pointer;
    }
    .quick-toggle img {
      width: 30px;
      height: 30px;
      margin-bottom: 5px;
    }

    /* Toast Notifications */
    .toast-container {
      position: fixed; bottom: 20%; left: 50%; transform: translateX(-50%);
      z-index: 9999; pointer-events: none;
    }
    .toast {
      background-color: rgba(0, 0, 0, 0.75); color: white;
      padding: 12px 16px; border-radius: 8px;
      margin-bottom: 10px; font-size: 15px; opacity: 0;
      transition: opacity 0.3s ease;
      text-align: center; max-width: 250px;
    }
    .toast.show {
      opacity: 1;
    }

    /* Animations */
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    /* Home Indicator */
    .home-indicator {
      width: 134px; height: 5px; background: #000; border-radius: 100px;
      margin: 8px auto; position: absolute; bottom: 8px; left: 50%;
      transform: translateX(-50%); z-index: 2;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Search Overlay -->
    <div class="search-overlay"></div>

    <!-- Status Bar -->
    <div class="status-bar">
      <div class="time">9:41</div>
      <div class="right">
        <img src="cellularbars.png" alt="Cellular Signal" />
        <img src="wifi-black.png" alt="Wi-Fi Status" />
        <img src="lte.png" alt="LTE Status" style="display: none;" />
        <img src="battery.75percent.png" alt="Battery" />
        <img src="airplane.png" alt="Airplane Status" />
      </div>
    </div>

    <!-- Breadcrumbs -->
    <div class="breadcrumb">
      <span class="breadcrumb-item">Settings</span>
    </div>

    <!-- Header -->
    <div class="header">Settings</div>

    <!-- Search Bar -->
    <div class="search-container">
      <input type="text" class="search-bar" placeholder="Search" />
      <img src="magnifyingglass.png" alt="Search Icon" class="search-icon" />
      <span class="clear-icon" role="button" aria-label="Clear search input">√ó</span>
      <div class="search-results"></div>
    </div>

    <!-- Profile Section -->
    <div class="profile-section">
      <div class="profile-item" tabindex="0" data-setting-id="apple-id" role="button" aria-haspopup="true">
        <div class="profile-avatar">
          <img src="profile.png" alt="Profile Photo" />
        </div>
        <div class="profile-info">
          <div class="profile-name">John Appleseed</div>
          <div class="profile-email">Apple ID, iCloud, Media & Purchases</div>
        </div>
        <div class="profile-chevron">‚Ä∫</div>
      </div>
    </div>

    <!-- Content Container -->
    <div class="content-container">
      <div class="pull-indicator">Pull to refresh</div>

      <!-- Pinned Connectivity Section -->
      <div class="pinned-section">
        <div class="connectivity-controls">
          <div class="connectivity-button" aria-label="Wi-Fi" role="button" data-setting-id="wifi">
            <div class="connectivity-icon icon-wifi">
              <img src="wifi.png" alt="Wi-Fi icon" />
            </div>
            <div class="connectivity-label">Wi-Fi</div>
          </div>
          <div class="connectivity-button" aria-label="Bluetooth" role="button" data-setting-id="bluetooth">
            <div class="connectivity-icon icon-bluetooth">
              <img src="bluetooth.png" alt="Bluetooth icon" />
            </div>
            <div class="connectivity-label">Bluetooth</div>
          </div>
          <div class="connectivity-button" aria-label="Airplane Mode" role="button" data-setting-id="airplane">
            <div class="connectivity-icon icon-airplane">
              <img src="airplane.png" alt="Airplane Mode icon" />
            </div>
            <div class="connectivity-label">Airplane</div>
          </div>
          <div class="connectivity-button" aria-label="Cellular" role="button" data-setting-id="cellular">
            <div class="connectivity-icon icon-cellular">
              <img src="antenna.radiowaves.left.and.right.png" alt="Cellular icon" />
            </div>
            <div class="connectivity-label">Cellular</div>
          </div>
        </div>
      </div>

      <!-- Recently Used -->
      <div class="section-header" data-collapse-target="#recentlyUsed">
        Recently Used
        <span class="collapse-arrow">‚ØÜ</span>
      </div>
      <div class="section" id="recentlyUsed">
        <div class="section-item" tabindex="0" data-setting-id="display-brightness" role="button" aria-haspopup="true">
          <div class="left-content">
            <div class="item-icon icon-display">
              <img src="sun.png" alt="Display Brightness Icon" />
            </div>
            <div class="item-name">Display Brightness</div>
          </div>
          <div class="right-content brightness-controls">
            <input type="range" class="brightness-range main-brightness-range" min="0" max="100" value="50" />
          </div>
        </div>
        <div class="section-item" tabindex="0" data-setting-id="wifi" role="button" aria-haspopup="true">
          <div class="left-content">
            <div class="item-icon icon-wifi">
              <img src="wifi.png" alt="Wi-Fi icon" />
            </div>
            <div class="item-name">Wi‚ÄëFi</div>
          </div>
          <div class="right-content">
            <div class="toggle-switch" role="switch" aria-checked="false"></div>
          </div>
        </div>
        <div class="section-item" tabindex="0" data-setting-id="bluetooth" role="button" aria-haspopup="true">
          <div class="left-content">
            <div class="item-icon icon-bluetooth">
              <img src="bluetooth.png" alt="Bluetooth icon" />
            </div>
            <div class="item-name">Bluetooth</div>
          </div>
          <div class="right-content">
            <div class="toggle-switch" role="switch" aria-checked="false"></div>
          </div>
        </div>
        <div class="section-item" tabindex="0" data-setting-id="low-power-mode" role="button" aria-haspopup="true">
          <div class="left-content">
            <div class="item-icon icon-battery">
              <img src="battery.100percent.png" alt="Battery icon" />
            </div>
            <div class="item-name">Low Power Mode</div>
          </div>
          <div class="right-content">
            <div class="toggle-switch" role="switch" aria-checked="false"></div>
          </div>
        </div>
        <div class="section-item" tabindex="0" data-setting-id="hotspot" role="button" aria-haspopup="true">
          <div class="left-content">
            <div class="item-icon icon-hotspot">
              <img src="hotspot.png" alt="Hotspot icon" />
            </div>
            <div class="item-name">Hotspot</div>
          </div>
          <div class="right-content">
            <div class="toggle-switch" role="switch" aria-checked="false"></div>
          </div>
        </div>
      </div>

      <!-- Display & Appearance -->
      <div class="section-header" data-collapse-target="#displayAppearance">
        Display & Appearance
        <span class="collapse-arrow">‚ØÜ</span>
      </div>
      <div class="section" id="displayAppearance">
        <div class="section-item" tabindex="0" data-setting-id="auto-dim" role="button" aria-haspopup="true">
          <div class="left-content">
            <div class="item-icon icon-display">
              <img src="wifi.png" style="opacity: 0;" alt="placeholder" />
              <span style="position:absolute;font-size:14px;opacity:0.9;">‚è±Ô∏è</span>
            </div>
            <div class="item-name">Auto-Dim Display</div>
          </div>
          <div class="right-content">
            <div class="toggle-switch active" role="switch" aria-checked="true"></div>
          </div>
        </div>
        <div class="section-item" tabindex="0" data-setting-id="dark-mode" role="button" aria-haspopup="true">
          <div class="left-content">
            <div class="item-icon icon-darkmode">
              <img src="wifi.png" style="opacity: 0;" alt="placeholder" />
              <span style="position:absolute;font-size:14px;opacity:0.9;">üåô</span>
            </div>
            <div class="item-name">Dark Mode</div>
          </div>
          <div class="right-content">
            <span>Auto</span>
            <span class="chevron">‚Ä∫</span>
          </div>
        </div>
        <div class="section-item" tabindex="0" data-setting-id="text-size" role="button" aria-haspopup="true">
          <div class="left-content">
            <div class="item-icon icon-text">
              <img src="wifi.png" style="opacity: 0;" alt="placeholder" />
              <span style="position:absolute;font-size:12px;opacity:0.9;">Aa</span>
            </div>
            <div class="item-name">Text Size</div>
          </div>
          <div class="right-content">
            <span class="chevron">‚Ä∫</span>
          </div>
        </div>
      </div>

      <!-- Connections -->
      <div class="section-header" data-collapse-target="#connectionsSection">
        Connections
        <span class="collapse-arrow">‚ØÜ</span>
      </div>
      <div class="section" id="connectionsSection">
        <div class="section-item" tabindex="0" data-setting-id="cellular" role="button" aria-haspopup="true">
          <div class="left-content">
            <div class="item-icon icon-cellular">
              <img src="antenna.radiowaves.left.and.right.png" alt="Cellular icon" />
            </div>
            <div class="item-name">Cellular</div>
          </div>
          <div class="right-content">
            <div class="toggle-switch" role="switch" aria-checked="false"></div>
          </div>
        </div>
        <div class="section-item" tabindex="0" data-setting-id="wifi-connections" role="button" aria-haspopup="true">
          <div class="left-content">
            <div class="item-icon icon-wifi">
              <img src="wifi.png" alt="Wi-Fi icon" />
            </div>
            <div class="item-name">Wi‚ÄëFi</div>
          </div>
          <div class="right-content">
            <span>Home_Network</span>
            <span class="chevron">‚Ä∫</span>
          </div>
        </div>
        <div class="section-item" tabindex="0" data-setting-id="bluetooth-connections" role="button" aria-haspopup="true">
          <div class="left-content">
            <div class="item-icon icon-bluetooth">
              <img src="bluetooth.png" alt="Bluetooth icon" />
            </div>
            <div class="item-name">Bluetooth</div>
          </div>
          <div class="right-content">
            <span>On</span>
            <span class="chevron">‚Ä∫</span>
          </div>
        </div>
      </div>

      <!-- System -->
      <div class="section-header" data-collapse-target="#systemSection">
        System
        <span class="collapse-arrow">‚ØÜ</span>
      </div>
      <div class="section" id="systemSection">
        <div class="section-item" tabindex="0" data-setting-id="software-update" role="button" aria-haspopup="true">
          <div class="left-content">
            <div class="item-icon icon-update">
              <img src="wifi.png" style="opacity: 0;" alt="placeholder" />
              <span style="position:absolute;font-size:14px;opacity:0.9;">‚Üª</span>
            </div>
            <div class="item-name">Software Update</div>
          </div>
          <div class="right-content">
            <span>Up to date</span>
            <span class="update-badge">1</span>
            <span class="chevron">‚Ä∫</span>
          </div>
        </div>
        <div class="section-item" tabindex="0" data-setting-id="battery" role="button" aria-haspopup="true">
          <div class="left-content">
            <div class="item-icon icon-battery">
              <img src="battery.100percent.bolt.png" alt="Battery icon" />
            </div>
            <div class="item-name">Battery</div>
          </div>
          <div class="right-content">
            <span>75%</span>
            <span class="chevron">‚Ä∫</span>
          </div>
        </div>
        <div class="section-item" tabindex="0" data-setting-id="storage" role="button" aria-haspopup="true">
          <div class="left-content">
            <div class="item-icon icon-storage">
              <img src="wifi.png" style="opacity:0;" alt="placeholder" />
              <span style="position:absolute;font-size:14px;opacity:0.9;">üì¶</span>
            </div>
            <div class="item-name">Storage</div>
          </div>
          <div class="right-content">
            <span>64.3 GB</span>
            <span class="chevron">‚Ä∫</span>
          </div>
        </div>
        <div class="section-item" tabindex="0" data-setting-id="reset-all" role="button" aria-haspopup="true">
          <div class="left-content">
            <div class="item-icon icon-reset">
              <img src="wifi.png" style="opacity:0;" alt="placeholder" />
              <span style="position:absolute;font-size:14px;opacity:0.9;">üîÑ</span>
            </div>
            <div class="item-name">Reset All Settings</div>
          </div>
          <div class="right-content">
            <span class="chevron">‚Ä∫</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Quick Settings Panel -->
    <div class="quick-settings-handle">
      <div class="handle-indicator"></div>
    </div>
    <div class="quick-settings-panel">
      <div class="quick-toggle" data-setting-id="wifi">
        <img src="wifi.png" alt="Wi-Fi" />
        <span>Wi-Fi</span>
      </div>
      <div class="quick-toggle" data-setting-id="bluetooth">
        <img src="bluetooth.png" alt="Bluetooth" />
        <span>Bluetooth</span>
      </div>
      <div class="quick-toggle" data-setting-id="airplane">
        <img src="airplane.png" alt="Airplane Mode" />
        <span>Airplane</span>
      </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Home Indicator -->
    <div class="home-indicator"></div>
  </div>

  <script>
    const settingsItems = [
      { id: "display-brightness", name: "Display Brightness", category: "Display & Appearance", keywords: ["display", "brightness", "screen", "light", "dim"], iconClass: "icon-display", hasToggle: false, brightnessValue: 50 },
      { id: "wifi", name: "Wi‚ÄëFi", category: "Connections", keywords: ["wifi", "wi-fi", "wireless", "network", "internet"], iconClass: "icon-wifi", hasToggle: true, toggleState: false },
      { id: "bluetooth", name: "Bluetooth", category: "Connections", keywords: ["bluetooth", "wireless", "headphones", "speaker", "connection"], iconClass: "icon-bluetooth", hasToggle: true, toggleState: false },
      { id: "airplane", name: "Airplane Mode", category: "Connections", keywords: ["airplane", "flight", "travel", "offline"], iconClass: "icon-airplane", hasToggle: true, toggleState: false },
      { id: "cellular", name: "Cellular", category: "Connections", keywords: ["cellular", "mobile", "data", "lte", "5g", "4g"], iconClass: "icon-cellular", hasToggle: true, toggleState: false },
      { id: "low-power-mode", name: "Low Power Mode", category: "Battery", keywords: ["low power", "battery", "save", "energy", "power"], iconClass: "icon-battery", hasToggle: true, toggleState: false },
      { id: "hotspot", name: "Hotspot", category: "Connections", keywords: ["hotspot", "tethering", "personal", "wifi", "share"], iconClass: "icon-hotspot", hasToggle: true, toggleState: false },
      { id: "auto-dim", name: "Auto-Dim Display", category: "Display & Appearance", keywords: ["auto", "dim", "display", "screen", "brightness"], iconClass: "icon-display", hasToggle: true, toggleState: true },
      { id: "dark-mode", name: "Dark Mode", category: "Display & Appearance", keywords: ["dark", "mode", "theme", "appearance", "night"], iconClass: "icon-darkmode", hasToggle: false },
      { id: "text-size", name: "Text Size", category: "Display & Appearance", keywords: ["text", "size", "font", "accessibility", "reading"], iconClass: "icon-text", hasToggle: false, textSizeValue: 14 },
      { id: "software-update", name: "Software Update", category: "System", keywords: ["software", "update", "ios", "version", "upgrade"], iconClass: "icon-update", hasToggle: false },
      { id: "battery", name: "Battery", category: "System", keywords: ["battery", "power", "charging", "health", "usage"], iconClass: "icon-battery", hasToggle: false },
      { id: "storage", name: "Storage", category: "System", keywords: ["storage", "memory", "space", "capacity", "icloud"], iconClass: "icon-storage", hasToggle: false },
      { id: "reset-all", name: "Reset All Settings", category: "System", keywords: ["reset", "factory", "erase", "settings"], iconClass: "icon-reset", hasToggle: false }
    ];

    /* DOM Elements */
    const searchInput = document.querySelector('.search-bar');
    const clearIcon = document.querySelector('.clear-icon');
    const searchOverlay = document.querySelector('.search-overlay');
    const searchResults = document.querySelector('.search-results');
    const toastContainer = document.getElementById('toast-container');
    const contentContainer = document.querySelector('.content-container');
    const pullIndicator = document.querySelector('.pull-indicator');

    /* Utility Functions */
    function showToast(message, duration = 2000) {
      const toast = document.createElement('div');
      toast.className = 'toast';
      toast.textContent = message;
      toastContainer.appendChild(toast);
      void toast.offsetWidth;
      toast.classList.add('show');
      setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => toastContainer.removeChild(toast), 300);
      }, duration);
    }

    function saveSettings() {
      localStorage.setItem('settings', JSON.stringify(settingsItems));
    }

    function loadSettings() {
      const savedSettings = localStorage.getItem('settings');
      if (savedSettings) {
        const parsedSettings = JSON.parse(savedSettings);
        settingsItems.forEach((item, index) => {
          const savedItem = parsedSettings.find(s => s.id === item.id);
          if (savedItem) {
            Object.assign(item, savedItem);
          }
        });
        updateSettingsUI();
      }
    }

    function updateSettingsUI() {
      document.querySelectorAll('.section-item .toggle-switch').forEach(toggle => {
        const itemRow = toggle.closest('.section-item');
        const settingId = itemRow.getAttribute('data-setting-id');
        const settingData = settingsItems.find(i => i.id === settingId);
        if (settingData && settingData.hasToggle) {
          const isActive = settingData.toggleState;
          toggle.classList.toggle('active', isActive);
          toggle.setAttribute('aria-checked', isActive ? 'true' : 'false');
          toggle.setAttribute('aria-label', `${settingData.name} is ${isActive ? 'enabled' : 'disabled'}`);
        }
      });
      const brightnessItem = settingsItems.find(i => i.id === "display-brightness");
      if (brightnessItem) {
        const mainSlider = document.querySelector('.main-brightness-range');
        if (mainSlider) mainSlider.value = brightnessItem.brightnessValue || 50;
      }
      ["wifi", "bluetooth", "airplane", "cellular"].forEach(id => {
        const item = settingsItems.find(s => s.id === id);
        if (item) syncToggleState(id, item.toggleState);
      });
      updateBatteryStatusIcon();
      showAirplaneStatus(settingsItems.find(i => i.id === "airplane").toggleState);
    }

    function updateTime() {
      const timeElement = document.querySelector('.status-bar .time');
      const now = new Date();
      const hours = now.getHours().toString().padStart(2, '0');
      const minutes = now.getMinutes().toString().padStart(2, '0');
      timeElement.textContent = `${hours}:${minutes}`;
    }

    function setTheme() {
      const darkModeMediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
      const theme = darkModeMediaQuery.matches ? 'dark' : 'light';
      document.documentElement.setAttribute('data-theme', theme);
      const darkModeItem = document.querySelector('.section-item[data-setting-id="dark-mode"] .right-content span');
      if (darkModeItem) darkModeItem.textContent = theme.charAt(0).toUpperCase() + theme.slice(1);
    }

    /* Collapsible Headers */
    document.querySelectorAll('.section-header').forEach(header => {
      header.addEventListener('click', () => {
        const targetSelector = header.getAttribute('data-collapse-target');
        if (!targetSelector) return;
        const section = document.querySelector(targetSelector);
        if (!section) return;
        section.classList.toggle('collapsed');
        const arrow = header.querySelector('.collapse-arrow');
        if (arrow) arrow.classList.toggle('collapsed-arrow');
      });
    });

    /* Search Logic */
    function toggleClearIcon() {
      if (searchInput.value.length > 0) {
        clearIcon.classList.add('visible');
        searchResults.classList.add('active');
        performSearch(searchInput.value);
      } else {
        clearIcon.classList.remove('visible');
        searchResults.classList.remove('active');
        displaySearchHistory();
      }
    }

    function performSearch(query) {
      searchResults.innerHTML = '';
      if (!query.trim()) {
        displaySearchHistory();
        return;
      }
      addToSearchHistory(query.trim());
      const lowerQuery = query.toLowerCase();
      const matchedSettings = settingsItems.filter(item => {
        if (item.name.toLowerCase().startsWith(lowerQuery)) return true;
        if (item.name.toLowerCase().includes(lowerQuery)) return true;
        return item.keywords.some(keyword => keyword.toLowerCase().includes(lowerQuery));
      });
      matchedSettings.sort((a, b) => {
        const aNameLower = a.name.toLowerCase();
        const bNameLower = b.name.toLowerCase();
        if (aNameLower === lowerQuery && bNameLower !== lowerQuery) return -1;
        if (bNameLower === lowerQuery && aNameLower !== lowerQuery) return 1;
        if (aNameLower.startsWith(lowerQuery) && !bNameLower.startsWith(lowerQuery)) return -1;
        if (bNameLower.startsWith(lowerQuery) && !aNameLower.startsWith(lowerQuery)) return 1;
        return a.name.localeCompare(b.name);
      });
      if (matchedSettings.length === 0) {
        searchResults.innerHTML = `<div class="no-results">No Settings Found</div>`;
        return;
      }
      matchedSettings.forEach(item => {
        const resultItem = document.createElement('div');
        resultItem.className = 'search-result-item';
        resultItem.setAttribute('data-setting-id', item.id);
        const startIndex = item.name.toLowerCase().indexOf(lowerQuery);
        let highlightedName = item.name;
        if (startIndex !== -1) {
          const endIndex = startIndex + lowerQuery.length;
          highlightedName = item.name.substring(0, startIndex) +
            `<span class="search-highlight">${item.name.substring(startIndex, endIndex)}</span>` +
            item.name.substring(endIndex);
        }
        let rightSideHTML = '';
        if (item.id === 'display-brightness') {
          rightSideHTML = `<div class="search-result-control"><input type="range" class="brightness-range search-brightness-range" min="0" max="100" value="${item.brightnessValue || 50}" /></div>`;
        } else if (item.id === 'text-size') {
          rightSideHTML = `<div class="search-result-control text-size-control"><button class="text-size-decrement">‚Äì</button><span class="text-size-value">${item.textSizeValue || 14}</span><button class="text-size-increment">+</button></div>`;
        } else if (item.hasToggle) {
          rightSideHTML = `<div class="search-result-toggle"><div class="toggle-switch ${item.toggleState ? 'active' : ''}" role="switch" aria-checked="${item.toggleState}" data-setting-id="${item.id}"></div></div>`;
        } else {
          rightSideHTML = `<div class="search-category">${item.category}</div>`;
        }
        resultItem.innerHTML = `
          <div class="search-result-icon ${item.iconClass}">
            <img src="wifi.png" style="opacity: 0;" alt="" />
            <span style="position:absolute;font-size:14px;opacity:0.9;">‚öôÔ∏è</span>
          </div>
          <div class="search-result-name">${highlightedName}</div>
          ${rightSideHTML}
        `;
        resultItem.addEventListener('click', (e) => {
          if (e.target.closest('.toggle-switch') || e.target.closest('.search-brightness-range') || e.target.closest('.text-size-control')) return;
          navigateToSetting(item.id);
        });
        searchResults.appendChild(resultItem);
      });
    }

    function addToSearchHistory(query) {
      let history = JSON.parse(localStorage.getItem('searchHistory') || '[]');
      history = history.filter(item => item !== query);
      history.unshift(query);
      history = history.slice(0, 5);
      localStorage.setItem('searchHistory', JSON.stringify(history));
    }

    function displaySearchHistory() {
      searchResults.innerHTML = '';
      const history = JSON.parse(localStorage.getItem('searchHistory') || '[]');
      if (history.length === 0) {
        searchResults.innerHTML = `<div class="no-results">No recent searches</div>`;
        return;
      }
      history.forEach(query => {
        const historyItem = document.createElement('div');
        historyItem.className = 'search-result-item';
        historyItem.textContent = query;
        historyItem.addEventListener('click', () => {
          searchInput.value = query;
          performSearch(query);
        });
        searchResults.appendChild(historyItem);
      });
      searchResults.classList.add('active');
    }

    function navigateToSetting(settingId) {
      const targetSetting = document.querySelector(`.section-item[data-setting-id="${settingId}"]`);
      if (targetSetting) {
        const parentSection = targetSetting.closest('.section');
        if (parentSection && parentSection.classList.contains('collapsed')) {
          parentSection.classList.remove('collapsed');
          const header = document.querySelector(`.section-header[data-collapse-target="#${parentSection.id}"]`);
          if (header) header.querySelector('.collapse-arrow').classList.remove('collapsed-arrow');
        }
        searchInput.value = '';
        searchResults.classList.remove('active');
        searchOverlay.classList.remove('active');
        toggleClearIcon();
        targetSetting.style.backgroundColor = '#e6f2ff';
        targetSetting.scrollIntoView({ behavior: 'smooth', block: 'center' });
        targetSetting.focus();
        setTimeout(() => { targetSetting.style.backgroundColor = ''; }, 1500);
      }
    }

    /* Event Delegation */
    contentContainer.addEventListener('click', (e) => {
      const toggle = e.target.closest('.toggle-switch');
      if (toggle) {
        e.stopPropagation();
        const itemRow = toggle.closest('.section-item');
        const settingId = itemRow.getAttribute('data-setting-id');
        const settingData = settingsItems.find(i => i.id === settingId);
        if (settingData) {
          const wasActive = toggle.classList.contains('active');
          toggle.classList.toggle('active');
          const isActive = toggle.classList.contains('active');
          toggle.setAttribute('aria-checked', isActive ? 'true' : 'false');
          toggle.setAttribute('aria-label', `${settingData.name} is ${isActive ? 'enabled' : 'disabled'}`);
          settingData.toggleState = isActive;
          if (isActive !== wasActive) {
            showToast(`${settingData.name} ${isActive ? 'On' : 'Off'}`);
            itemRow.classList.add('setting-changed');
            setTimeout(() => itemRow.classList.remove('setting-changed'), 300);
          }
          if (["wifi", "bluetooth", "cellular", "hotspot"].includes(settingId) && isActive) {
            const airplaneItem = settingsItems.find(a => a.id === "airplane");
            if (airplaneItem && airplaneItem.toggleState) turnOffAirplane();
          }
          if (["wifi", "bluetooth", "cellular"].includes(settingId)) syncToggleState(settingId, isActive);
          if (settingId === "low-power-mode") updateBatteryStatusIcon();
          saveSettings();
        }
        if (navigator.vibrate) navigator.vibrate(5);
      }
      const sectionItem = e.target.closest('.section-item');
      if (sectionItem && !toggle) {
        const settingId = sectionItem.getAttribute('data-setting-id');
        if (settingId === "reset-all") {
          if (confirm('Are you sure you want to reset all settings? This action cannot be undone.')) {
            settingsItems.forEach(item => {
              if (item.hasToggle) item.toggleState = false;
              if (item.id === 'display-brightness') item.brightnessValue = 50;
            });
            updateSettingsUI();
            showToast('All settings have been reset.');
            saveSettings();
          }
        } else {
          sectionItem.classList.add('slide-left');
          setTimeout(() => sectionItem.classList.remove('slide-left'), 300);
          showToast(`Navigating to ${settingsItems.find(i => i.id === settingId).name}`);
        }
      }
    });

    document.querySelectorAll('.connectivity-button').forEach(button => {
      button.addEventListener('click', function() {
        const icon = this.querySelector('.connectivity-icon');
        const settingId = this.getAttribute('data-setting-id');
        const wasActive = icon.classList.contains('active');
        icon.classList.toggle('active');
        const isActive = icon.classList.contains('active');
        if (settingId === "airplane") {
          const planeItem = settingsItems.find(i => i.id === "airplane");
          if (planeItem) planeItem.toggleState = isActive;
          if (!wasActive) turnOnAirplane();
          else turnOffAirplane();
        } else {
          if (["wifi", "bluetooth", "cellular", "hotspot"].includes(settingId) && isActive) {
            const airplaneItem = settingsItems.find(a => a.id === "airplane");
            if (airplaneItem && airplaneItem.toggleState) turnOffAirplane();
          }
          syncToggleState(settingId, isActive);
          const label = this.querySelector('.connectivity-label').textContent;
          if (isActive !== wasActive) showToast(`${label} ${isActive ? 'On' : 'Off'}`);
        }
        saveSettings();
        if (navigator.vibrate) navigator.vibrate(5);
      });
    });

    /* Airplane Mode Logic */
    function turnOnAirplane() {
      ["wifi", "bluetooth", "cellular", "hotspot"].forEach(id => {
        const pinnedIcon = document.querySelector(`.connectivity-button[data-setting-id="${id}"] .connectivity-icon`);
        const settingItem = settingsItems.find(s => s.id === id);
        if (pinnedIcon && pinnedIcon.classList.contains('active')) {
          pinnedIcon.classList.remove('active');
          if (settingItem) {
            settingItem.toggleState = false;
            syncToggleState(id, false);
            showToast(`${settingItem.name} Off`);
          }
        }
      });
      showAirplaneStatus(true);
      showToast("Airplane On");
      saveSettings();
    }

    function turnOffAirplane() {
      const planeItem = settingsItems.find(s => s.id === "airplane");
      if (planeItem) planeItem.toggleState = false;
      const pinnedIcon = document.querySelector('.connectivity-button[data-setting-id="airplane"] .connectivity-icon');
      if (pinnedIcon) pinnedIcon.classList.remove('active');
      showAirplaneStatus(false);
      showToast("Airplane Off");
      saveSettings();
    }

    function showAirplaneStatus(isOn) {
      const airplaneIconTop = document.querySelector('.status-bar img[alt="Airplane Status"]');
      const cellIcon = document.querySelector('.status-bar img[alt="Cellular Signal"]');
      const wifiIcon = document.querySelector('.status-bar img[alt="Wi-Fi Status"]');
      const lteIcon = document.querySelector('.status-bar img[alt="LTE Status"]');
      const batteryIcon = document.querySelector('.status-bar img[alt="Battery"]');
      if (batteryIcon) batteryIcon.style.display = 'inline';
      if (airplaneIconTop) airplaneIconTop.style.display = isOn ? 'inline' : 'none';
      if (isOn) {
        if (cellIcon) cellIcon.style.display = 'none';
        if (wifiIcon) wifiIcon.style.display = 'none';
        if (lteIcon) lteIcon.style.display = 'none';
      } else {
        if (cellIcon) cellIcon.style.display = 'inline';
        const wifiSetting = settingsItems.find(s => s.id === "wifi");
        const cellularSetting = settingsItems.find(s => s.id === "cellular");
        if (wifiIcon) wifiIcon.style.display = wifiSetting?.toggleState ? 'inline' : 'none';
        if (lteIcon) lteIcon.style.display = cellularSetting?.toggleState ? 'inline' : 'none';
      }
    }

    function syncToggleState(settingId, newState) {
      const pinnedIcon = document.querySelector(`.connectivity-button[data-setting-id="${settingId}"] .connectivity-icon`);
      if (pinnedIcon) pinnedIcon.classList.toggle('active', newState);
      const mainToggle = document.querySelector(`.section-item[data-setting-id="${settingId}"] .toggle-switch`);
      if (mainToggle) {
        mainToggle.classList.toggle('active', newState);
        mainToggle.setAttribute('aria-checked', newState ? 'true' : 'false');
        mainToggle.setAttribute('aria-label', `${settingsItems.find(i => i.id === settingId).name} is ${newState ? 'enabled' : 'disabled'}`);
      }
      const settingData = settingsItems.find(i => i.id === settingId);
      if (settingData && settingData.hasToggle) settingData.toggleState = newState;
      if (settingId === "wifi") {
        const wifiStatusIcon = document.querySelector('.status-bar img[alt="Wi-Fi Status"]');
        if (wifiStatusIcon) wifiStatusIcon.style.display = newState ? 'inline' : 'none';
      }
      if (settingId === "cellular") {
        const lteStatusIcon = document.querySelector('.status-bar img[alt="LTE Status"]');
        if (lteStatusIcon) lteStatusIcon.style.display = newState ? 'inline' : 'none';
      }
    }

    function updateBatteryStatusIcon() {
      const batteryImg = document.querySelector('.status-bar img[alt="Battery"]');
      const lowPowerSetting = settingsItems.find(item => item.id === "low-power-mode");
      if (batteryImg && lowPowerSetting) {
        batteryImg.src = lowPowerSetting.toggleState ? "battery.75percent.yello.png" : "battery.75percent.png";
      }
    }

    /* Pull-to-Refresh */
    let startY;
    contentContainer.addEventListener('touchstart', (e) => {
      startY = e.touches[0].clientY;
    });
    contentContainer.addEventListener('touchmove', (e) => {
      const currentY = e.touches[0].clientY;
      const diff = currentY - startY;
      if (diff > 50 && window.scrollY <= 0) {
        pullIndicator.classList.add('visible');
      }
    });
    contentContainer.addEventListener('touchend', () => {
      pullIndicator.classList.remove('visible');
      showToast('Settings refreshed');
    });

    /* Gesture Support */
    let touchStartX = 0;
    document.addEventListener('touchstart', (e) => {
      touchStartX = e.touches[0].clientX;
    });
    document.addEventListener('touchend', (e) => {
      const touchEndX = e.changedTouches[0].clientX;
      const diff = touchEndX - touchStartX;
      if (diff > 100 && searchOverlay.classList.contains('active')) {
        searchInput.value = '';
        searchResults.classList.remove('active');
        searchOverlay.classList.remove('active');
        toggleClearIcon();
      }
    });

    /* 3D Touch Preview */
    let pressTimer;
    document.querySelectorAll('.section-item').forEach(item => {
      item.addEventListener('touchstart', () => {
        pressTimer = setTimeout(() => {
          const settingId = item.getAttribute('data-setting-id');
          const settingData = settingsItems.find(i => i.id === settingId);
          if (settingData) showToast(`Preview: ${settingData.name}`);
        }, 500);
      });
      item.addEventListener('touchend', () => {
        clearTimeout(pressTimer);
      });
    });

    /* Quick Settings Panel */
    document.querySelector('.quick-settings-handle').addEventListener('click', () => {
      document.querySelector('.quick-settings-panel').classList.toggle('active');
    });
    document.querySelectorAll('.quick-toggle').forEach(toggle => {
      toggle.addEventListener('click', () => {
        const settingId = toggle.getAttribute('data-setting-id');
        const settingData = settingsItems.find(i => i.id === settingId);
        if (settingData && settingData.hasToggle) {
          settingData.toggleState = !settingData.toggleState;
          syncToggleState(settingId, settingData.toggleState);
          showToast(`${settingData.name} ${settingData.toggleState ? 'On' : 'Off'}`);
          saveSettings();
        }
      });
    });

    /* Scrolling Header Effect */
    window.addEventListener('scroll', () => {
      const header = document.querySelector('.header');
      if (window.scrollY > 20) {
        header.classList.add('compact');
      } else {
        header.classList.remove('compact');
      }
    });

    /* Search Bar Events */
    searchInput.addEventListener('input', toggleClearIcon);
    clearIcon.addEventListener('click', () => {
      searchInput.value = '';
      toggleClearIcon();
      searchInput.focus();
    });
    searchInput.addEventListener('focus', function() {
      searchOverlay.classList.add('active');
      this.style.transform = 'scale(0.99)';
      if (this.value.trim().length === 0) {
        displaySearchHistory();
      } else {
        searchResults.classList.add('active');
        performSearch(this.value);
      }
    });
    document.addEventListener('click', (e) => {
      if (!e.target.closest('.search-container')) {
        searchResults.classList.remove('active');
        searchOverlay.classList.remove('active');
      }
    });
    document.addEventListener('keydown', (e) => {
      if (!e.ctrlKey && !e.metaKey && !e.altKey && e.key.length === 1 && document.activeElement !== searchInput && document.activeElement.tagName !== 'INPUT') {
        searchInput.focus();
        if (searchInput.value.length === 0) {
          searchInput.value = e.key;
          toggleClearIcon();
          e.preventDefault();
        }
      }
    });

    /* Keyboard Accessibility */
    document.querySelectorAll('.section-item, .toggle-switch').forEach(elem => {
      elem.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          elem.click();
        }
      });
    });

    /* Brightness Slider */
    const mainSlider = document.querySelector('.main-brightness-range');
    if (mainSlider) {
      mainSlider.addEventListener('input', function() {
        const brightnessItem = settingsItems.find(i => i.id === "display-brightness");
        if (brightnessItem) {
          brightnessItem.brightnessValue = parseInt(this.value, 10);
          saveSettings();
        }
      });
    }

    /* Lazy Loading */
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          console.log(`Section ${entry.target.id} is in view`);
          observer.unobserve(entry.target);
        }
      });
    }, { rootMargin: '100px' });
    document.querySelectorAll('.section').forEach(section => observer.observe(section));

    /* Initialization */
    window.addEventListener('DOMContentLoaded', () => {
      loadSettings();
      setInterval(updateTime, 60000);
      updateTime();
      setTheme();
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', setTheme);
    });
  </script>
</body>
</html>
